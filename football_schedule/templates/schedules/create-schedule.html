{% extends 'base.html' %}

{% load add_days %}
{% load static %}



{% block content %}
    {% include 'head.html' with bootstrap=True %}
    <section class="m-5">
    <form method="post">
        {% csrf_token %}
        <h3 class="text-center">Начална дата</h3>
        <p class="text-center">{{ form.start_date }}</p>
        <h3 class="text-center">Понеделник</h3>
        <div id="monday" class="d-flex justify-content-around">
            <p class="">Вид: {{ form.monday_type }}</p>
            <p class="text-center">Време: {{ form.monday_time }}</p>
            <p class="text-center">Място: {{ form.monday_place }}</p>
        </div>
        
        <h3 class="text-center">Вторник</h3>
        <div id="monday" class="d-flex justify-content-around">
            <p class="">Вид: {{ form.tuesday_type }}</p>
            <p class="text-center">Време: {{ form.tuesday_time }}</p>
            <p class="text-center">Място: {{ form.tuesday_place }}</p>
        </div>
        
        <h3 class="text-center">Сряда</h3>
        <div id="monday" class="d-flex justify-content-around">
            <p class="">Вид: {{ form.tuesday_type }}</p>
            <p class="text-center">Време: {{ form.tuesday_time }}</p>
            <p class="text-center">Място: {{ form.tuesday_place }}</p>
        </div>
        
        <h3 class="text-center">Четвъртък</h3>
        <div id="monday" class="d-flex justify-content-around">
            <p class="">Вид: {{ form.tuesday_type }}</p>
            <p class="text-center">Време: {{ form.tuesday_time }}</p>
            <p class="text-center">Място: {{ form.tuesday_place }}</p>
        </div>
        
        <h3 class="text-center">Петък</h3>
        <div id="monday" class="d-flex justify-content-around">
            <p class="">Вид: {{ form.tuesday_type }}</p>
            <p class="text-center">Време: {{ form.tuesday_time }}</p>
            <p class="text-center">Място: {{ form.tuesday_place }}</p>
        </div>
        
        <h3 class="text-center">Събота</h3>
        <div id="monday" class="d-flex justify-content-around">
            <p class="">Вид: {{ form.tuesday_type }}</p>
            <p class="text-center">Време: {{ form.tuesday_time }}</p>
            <p class="text-center">Място: {{ form.tuesday_place }}</p>
        </div>
        
        <h3 class="text-center">Неделя</h3>
        <div id="monday" class="d-flex justify-content-around">
            <p class="">Вид: {{ form.tuesday_type }}</p>
            <p class="text-center">Време: {{ form.tuesday_time }}</p>
            <p class="text-center">Място: {{ form.tuesday_place }}</p>
        </div>
{#        {{ form }}#}
        <div class="d-flex justify-content-center">
            <button class="btn px-5 py-2  btn-primary text-center">Създай седмица</button>
        </div>
    </form>
    </section>

    <ul>
        {% for week in weeks %}
            <li>{{ week.start_date }} - {{ week.start_date|add_days:7 }}</li>
        {% endfor %}
    </ul>

    <button id="delete-weeks" class="btn btn-danger">Delete All Weeks</button>

{% endblock %}

<script>
    document.getElementById('delete-weeks').addEventListener('click', function () {
        if (confirm('Are you sure you want to delete all weeks?')) {
            fetch(window.location.href, {
                method: 'DELETE',
                headers: {
                    'X-CSRFToken': '{{ csrf_token }}', // Include CSRF token
                    'Content-Type': 'application/json',
                },
            })
                .then(response => response.json())
                .then(data => {
                    alert(data.message);
                    location.reload(); // Reload the page after deletion
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('An error occurred while deleting weeks.');
                });
        }
    });
</script>